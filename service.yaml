apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: jobtracker-service
  labels:
    cloud.googleapis.com/location: asia-south1
spec:
  template:
    metadata:
      annotations:
        autoscaling.knative.dev/minScale: "0"
        autoscaling.knative.dev/maxScale: "5"
    spec:
      containers:
      - image: asia-south1-docker.pkg.dev/job-tracker-pro-480917/my-repo/my-java-app:v1
        ports:
        - containerPort: 8080
        env:
        - name: SPRING_PROFILES_ACTIVE
          value: "prod"
        
        - name: JDBC_URL
          valueFrom:
            secretKeyRef:
              name: jdbc-url
              key: latest
        - name: JDBC_USER
          valueFrom:
            secretKeyRef:
              name: jdbc-user
              key: latest
        - name: JDBC_PASS
          valueFrom:
            secretKeyRef:
              name: jdbc-pass
              key: latest

        - name: JWT_SECRET
          valueFrom:
            secretKeyRef:
              name: jwt-secret
              key: latest
        - name: GOOGLE_CLIENT_ID
          valueFrom:
            secretKeyRef:
              name: google-id
              key: latest
        - name: GOOGLE_CLIENT_SECRET
          valueFrom:
            secretKeyRef:
              name: google-secret
              key: latest
        - name: GITHUB_CLIENT_ID
          valueFrom:
            secretKeyRef:
              name: github-id
              key: latest
        - name: GITHUB_CLIENT_SECRET
          valueFrom:
            secretKeyRef:
              name: github-secret
              key: latest
        - name: CLOUDFLARE_ACCESS_KEY
          valueFrom:
            secretKeyRef:
              name: cloudflare-access-key
              key: latest
        - name: CLOUDFLARE_SECRET_KEY
          valueFrom:
            secretKeyRef:
              name: cloudflare-secret-key
              key: latest
        - name: CLOUDFLARE_ENDPOINT
          valueFrom:
            secretKeyRef:
              name: cloudflare-endpoint
              key: latest
        - name: CLOUDFLARE_BUCKET
          valueFrom:
            secretKeyRef:
              name: cloudflare-bucket
              key: latest
        - name: CLOUDFLARE_PUBLIC_URL
          valueFrom:
            secretKeyRef:
              name: cloudflare-public-url
              key: latest
        - name: EMAIL_HOST
          valueFrom:
            secretKeyRef:
              name: email-host
              key: latest
        - name: EMAIL_PORT
          valueFrom:
            secretKeyRef:
              name: email-port
              key: latest
        - name: EMAIL_USER_NAME
          valueFrom:
            secretKeyRef:
              name: email-user-name
              key: latest
        - name: EMAIL_SMTP_KEY
          valueFrom:  
            secretKeyRef:
              name: email-smtp-key
              key: latest
        - name: EMAIL_SENDER
          valueFrom:
            secretKeyRef:
              name: email-sender
              key: latest
        - name: EMAIL_SENDER_NAME
          valueFrom:
            secretKeyRef:
              name: email-sender-name
              key: latest
        - name: EMAIL_SENDER_ADDRESS
          valueFrom:
            secretKeyRef:
              name: email-sender-address
              key: latest